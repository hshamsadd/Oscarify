(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();async function f(e,t,r=1440){const a=localStorage.getItem(e),n=localStorage.getItem(`${e}_time`);if(a&&n&&(Date.now()-parseInt(n))/6e4<r)return JSON.parse(a);const o=await t();return localStorage.setItem(e,JSON.stringify(o)),localStorage.setItem(`${e}_time`,Date.now().toString()),o}const w="cf2ff3318b0791f5bd3babb84c3ed850",$="/oscarsData.json";let l=[],C={};async function E(){return f("oscar_data",async()=>await(await fetch(`${$}`)).json(),10080)}async function L(){return f("tmdb_config",async()=>await(await fetch(`https://api.themoviedb.org/3/configuration?api_key=${w}`)).json(),10080)}async function _(e){return f(`movie_${e}`,async()=>{try{const r=await(await fetch(`https://api.themoviedb.org/3/find/${e}?api_key=${w}&external_source=imdb_id`)).json();return r.movie_results&&r.movie_results.length>0?r.movie_results[0]:(console.warn(`No TMDb data found for IMDb ID: ${e}`),null)}catch(t){return console.error(`Failed to fetch details for IMDb ID ${e}:`,t),null}},10080)}const d=document.getElementById("year-filter"),u=document.getElementById("category-filter"),c=document.getElementById("search-btn"),p=document.getElementById("results"),h=document.getElementById("loading"),m=document.getElementById("error"),b=document.querySelector(".theme-toggle");function F(){const e=localStorage.getItem("theme")||"dark";document.documentElement.setAttribute("data-theme",e)}function D(){const t=document.documentElement.getAttribute("data-theme")==="dark"?"light":"dark";return document.documentElement.setAttribute("data-theme",t),localStorage.setItem("theme",t),t}function S(){F(),b.addEventListener("click",()=>{D()})}function T(e){const t=[...new Set(e.map(a=>a.Year))].sort(),r=[...new Set(e.map(a=>a.CanonicalCategory))].sort();y(d,t),y(u,r)}function y(e,t){t.forEach(r=>{const a=document.createElement("option");a.value=r,a.textContent=r,e.appendChild(a)})}function v(e){e.disabled=!(d.value&&u.value)}function N(e,t,r,a=[]){p.innerHTML="",p.appendChild(A(e,t,r,a))}function A(e,t,r,a){const n=document.createElement("div");return n.className="movie-card",n.innerHTML=O(e,t,r,a),n}function O(e,t,r,a){return`
    <img src="${M(t,r)}" alt="${t.title||e.Film} poster">
    <div class="movie-info">
      <h3>${t.title||e.Film} (${Y(t)})</h3>
      <div class="awards-container">
        <div class="oscar-badge primary">üèÜ ${e.CanonicalCategory}</div>
        ${a.length>0?`
          <div class="additional-wins">
            <span class="wins-label"></span>
            ${a.map(n=>`
              <span class="oscar-badge secondary">üèÜ ${n.CanonicalCategory}</span>
            `).join("")}
          </div>
        `:""}
      </div>
      <p><strong>Winner:</strong> ${e.Name}</p>
      <p><strong>Year:</strong> ${e.Year}</p>
      <p class="overview">${t.overview||"No overview available."}</p>
      <div class="rating">‚≠ê ${B(t)}/10</div>
    </div>
  `}function M(e,t){return e.poster_path?`${t.images.secure_base_url}w300${e.poster_path}`:"/placeholder.png"}function Y(e){return e.release_date?new Date(e.release_date).getFullYear():"N/A"}function B(e){return parseFloat(e.vote_average?.toFixed(1))||"N/A"}function I(){h.classList.remove("hidden"),m.classList.add("hidden")}function g(){h.classList.add("hidden")}function s(e){m.textContent=e,m.classList.remove("hidden"),h.classList.add("hidden")}async function P(){S();try{l.push(...await E()),Object.assign(C,await L()),T(l),c.disabled=!0,d.addEventListener("change",()=>v(c)),u.addEventListener("change",()=>v(c)),c.addEventListener("click",j)}catch(e){s(`Failed to start: ${e.message}`)}}async function j(){try{I();const e=d.value,t=u.value;if(!e||!t){s("Please select both a year and a category."),g();return}const r=l.find(n=>n.Winner&&n.Winner.toLowerCase()==="true"&&String(n.Year).trim()===e&&n.CanonicalCategory===t);if(!r){s(`No winner found in ${e} for ${t} category.`),g();return}const a=await _(r.FilmId);if(a){const n=l.filter(o=>o.FilmId===r.FilmId&&o.Year===r.Year&&o.CanonicalCategory!==r.CanonicalCategory&&o.Winner?.toLowerCase()==="true");N(r,a,C,n)}else s(`No details found for "${r.Film}".`);g()}catch(e){s(`Failed to load winner: ${e.message}`)}}addEventListener("DOMContentLoaded",P);
